<?php
 require_once( '../../common/config.ini' ); require_once( '../../common/users.php' ); require_once( '../../common/mails.php' ); require_once( '../../common/logs.php' ); session_start(); $usersObj = new users(); $mailsObj = new mails(); $logsObj = new logs(); if( $usersObj->get_auth_session( $_SESSION, $user )) { if( $usersObj->db_login( $user['email'], $user['password'], $auth=ADMIN_ROLL, $user )) { session_regenerate_id( TRUE ); } else { $userObj->session_dell(); } } else { header( 'Location:'.URL.'/admin/' ); } if( $_SERVER['REQUEST_METHOD'] == 'POST' || $_SERVER['REQUEST_METHOD'] == 'GET' ) { $mailsObj->get_data($_REQUEST, $form_data); (!isset($form_data['status'])) ? $form_data['status'] = '':NULL; } switch ($form_data['status']) { case 'step': if( !$mailsObj->get_all_stepmail( $step_mails_data )) { $message = "ステップメールが登録されていません。"; } require_once( 'list_step.php' ); break; case 'extra': if( !$mailsObj->get_all_extra_mail( $extra_mails_data )) { $message = "号外メールが登録されていません。"; } require_once( 'list_extra.php' ); break; default: $form_data['status'] = 'default'; require_once( 'top.php' ); break; } ?>