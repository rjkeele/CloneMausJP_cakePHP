<?php
 require_once( dirname(__FILE__).'/main.php' ); class bodys extends main { function db_add_body( $data ) { $now = $this->get_now_date(); try { $sql = "INSERT INTO `bodys` (`id`, `title`, `body`, `type`, `created`, `modified`)
					VALUES (NULL, :title, :body, :type, :created, NULL);"; $this->stmt = $this->pdo->prepare( $sql ); $this->stmt->bindValue( ':title', $data['title'] ); $this->stmt->bindValue( ':body', $data['body'] ); $this->stmt->bindValue( ':type', $data['type'] ); $this->stmt->bindValue( ':created', $now ); $this->stmt->execute(); } catch( PDOException $e ){ die( $e->getMessage() ); } } function db_edit_body( $data ) { $now = $this->get_now_date(); try { $sql = "UPDATE `bodys`
					SET `title` = :title, `body` = :body, `modified` = :modified
					WHERE `bodys`.`id` = :id;"; $this->stmt = $this->pdo->prepare( $sql ); $this->stmt->bindValue( ':title', $data['title'] ); $this->stmt->bindValue( ':body', $data['body'] ); $this->stmt->bindValue( ':modified', $now ); $this->stmt->bindValue( ':id', $data['id'], PDO::PARAM_INT ); $this->stmt->execute(); } catch( PDOException $e ){ die( $e->getMessage() ); } } function get_all_body( $type, $start, $num, &$data ) { $result = FALSE; $this->db_all_body( $type, $start, $num ); $row = $this->stmt->fetchAll(); $cnt = count( $row ); if($cnt == 1) { $data = $row; $result = TRUE; } return $result; } private function db_all_body( $type, $start, $num ) { try { $sql = "SELECT * FROM `bodys` WHERE `type` = :type LIMIT :start, :num"; $this->stmt = $this->pdo->prepare( $sql ); $this->stmt->bindValue( ':type', $type, PDO::PARAM_INT ); $this->stmt->bindValue( ':start', $start, PDO::PARAM_INT ); $this->stmt->bindValue( ':num', $num, PDO::PARAM_INT ); $this->stmt->execute(); } catch(PDOException $e){ die($e->getMessage()); } } function get_body( $id, &$data ) { $result = false; $this->db_body( $id ); $row = $this->stmt->fetchAll(); $cnt = count( $row ); if($cnt == 1) { $data = $row[0]; $result = true; } return $result; } private function db_body( $id ) { try { $sql = "SELECT * FROM `bodys` WHERE `id` = :id"; $this->stmt = $this->pdo->prepare( $sql ); $this->stmt->bindValue( ':id', $id, PDO::PARAM_INT ); $this->stmt->execute(); } catch(PDOException $e){ die($e->getMessage()); } } } ?>